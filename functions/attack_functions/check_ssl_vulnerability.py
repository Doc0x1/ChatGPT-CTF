import random

def check_ssl_vulnerability(domains=None, subdomains=None):
    print(f"\033[91mSSL/TLS Vulnerability Check called by ChatGPT\033[0m")
    
    targets = []
    
    if domains:
        if isinstance(domains, str):  # If only one domain is given as a string
            targets.append(domains)
        elif isinstance(domains, list):  # If multiple domains are given as a list
            targets.extend(domains)
    
    if subdomains:
        if isinstance(subdomains, str):  # If only one subdomain is given as a string
            targets.append(subdomains)
        elif isinstance(subdomains, list):  # If multiple subdomains are given as a list
            targets.extend(subdomains)
    
    # Ensure that targets are unique
    targets = list(set(targets))
    
    all_vulnerability_results = {}
    
    vulnerabilities = [
        "No SSL/TLS vulnerabilities detected.",
        "Heartbleed vulnerability detected!",
        "POODLE attack vulnerability detected!"
    ]

    # Assign weights to vulnerabilities
    weights = [95, 2.5, 2.5]  # 95% chance for no vulnerabilities, 2.5% for Heartbleed and 2.5% for POODLE
    
    for target in targets:
        selected_vulnerability = random.choices(vulnerabilities, weights=weights, k=1)[0]
        all_vulnerability_results[target] = f"{selected_vulnerability} for {target}." if selected_vulnerability == vulnerabilities[0] else f"{selected_vulnerability} on {target}!"
    
    return {
        "vulnerabilities": all_vulnerability_results
    }
